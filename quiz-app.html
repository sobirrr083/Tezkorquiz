<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Tezkor Quiz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f4f6f9;
        }
        .quiz-container {
            max-width: 800px;
            margin: 50px auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .btn-option {
            margin-bottom: 10px;
            text-align: left;
            width: 100%;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="quiz-container">
            <div class="text-center mb-4">
                <h1>TEZKOR QUIZ</h1>
                <div id="quiz-info" class="text-muted"></div>
            </div>

            <div id="quiz-area">
                <div class="mb-3">
                    <h3 id="question-text"></h3>
                </div>
                <div id="options-container" class="d-grid gap-2"></div>
            </div>

            <div class="mt-3 text-center">
                <button id="next-btn" class="btn btn-primary">Keyingi savol</button>
            </div>

            <div id="result-container" class="text-center mt-4" style="display:none;">
                <h2>Quiz yakunlandi</h2>
                <p>Sizning natijangiz: <span id="final-score"></span></p>
                <button id="restart-btn" class="btn btn-success">Qayta boshlash</button>
            </div>
        </div>

        <div class="container mt-4">
            <div class="card">
                <div style="size: 15px" class="card-header"><b>quiz .txt fayilni tanlang:</b></div>
                <div class="card-body">
                    <input type="file" id="quiz-file" class="form-control" accept=".txt">
                    <small class="text-muted">
                        <b>Fayl farmati:</b>
                        <br>
                        Savol: (Savol matini) <br>
                        A) 1-variant <br>
                        B) 2-variant <br>
                        C) 3-variant <br>
                        D) 4-variant <br>
                        Correct: (Bu joyga to'g'ri javob yoziladi. Namuna: Correct: A)
                    </small>
                </div>
            </div>
        </div>
    </div>

    <script>
        class QuizApp {
            constructor() {
                this.questions = [];
                this.currentQuestionIndex = 0;
                this.score = 0;

                this.initializeElements();
                this.attachEventListeners();
            }

            initializeElements() {
                this.quizArea = document.getElementById('quiz-area');
                this.questionText = document.getElementById('question-text');
                this.optionsContainer = document.getElementById('options-container');
                this.nextButton = document.getElementById('next-btn');
                this.resultContainer = document.getElementById('result-container');
                this.finalScoreElement = document.getElementById('final-score');
                this.restartButton = document.getElementById('restart-btn');
                this.quizInfoElement = document.getElementById('quiz-info');
                this.quizFileInput = document.getElementById('quiz-file');
            }

            attachEventListeners() {
                this.nextButton.addEventListener('click', () => this.nextQuestion());
                this.restartButton.addEventListener('click', () => this.restartQuiz());
                this.quizFileInput.addEventListener('change', (e) => this.loadQuizFile(e));
            }

            loadQuizFile(event) {
                const file = event.target.files[0];
                const reader = new FileReader();

                reader.onload = (e) => {
                    const content = e.target.result;
                    this.parseQuizContent(content);
                };

                reader.readAsText(file);
            }

            parseQuizContent(content) {
                const lines = content.trim().split('\n');
                this.questions = [];
                let currentQuestion = null;

                for (let line of lines) {
                    line = line.trim();
                    if (line.startsWith('Question:')) {
                        if (currentQuestion) {
                            this.questions.push(currentQuestion);
                        }
                        currentQuestion = {
                            question: line.replace('Question:', '').trim(),
                            options: [],
                            correctOption: null
                        };
                    } else if (line.match(/^[A-D]\)/)) {
                        currentQuestion.options.push(line);
                    } else if (line.startsWith('Correct:')) {
                        currentQuestion.correctOption = line.replace('Correct:', '').trim();
                    }
                }

                if (currentQuestion) {
                    this.questions.push(currentQuestion);
                }

                this.quizInfoElement.textContent = `Total Questions: ${this.questions.length}`;
                this.startQuiz();
            }

            startQuiz() {
                this.currentQuestionIndex = 0;
                this.score = 0;
                this.resultContainer.style.display = 'none';
                this.quizArea.style.display = 'block';
                this.displayQuestion();
            }

            displayQuestion() {
                const currentQuestion = this.questions[this.currentQuestionIndex];
                this.questionText.textContent = currentQuestion.question;

                this.optionsContainer.innerHTML = '';
                currentQuestion.options.forEach((option, index) => {
                    const optionButton = document.createElement('button');
                    optionButton.textContent = option;
                    optionButton.classList.add('btn', 'btn-outline-primary', 'btn-option');
                    optionButton.addEventListener('click', () => this.selectOption(option));
                    this.optionsContainer.appendChild(optionButton);
                });

                if (this.currentQuestionIndex === this.questions.length - 1) {
                    this.nextButton.textContent = 'Finish Quiz';
                }
            }

            selectOption(selectedOption) {
                const buttons = this.optionsContainer.querySelectorAll('.btn');
                buttons.forEach(btn => {
                    btn.classList.remove('btn-success', 'btn-danger');
                    btn.disabled = true;
                });

                const currentQuestion = this.questions[this.currentQuestionIndex];
                const selectedButton = Array.from(buttons).find(btn => btn.textContent === selectedOption);

                if (selectedOption.startsWith(currentQuestion.correctOption)) {
                    selectedButton.classList.add('btn-success');
                    this.score++;
                } else {
                    selectedButton.classList.add('btn-danger');
                    const correctButton = Array.from(buttons).find(btn => 
                        btn.textContent.startsWith(currentQuestion.correctOption)
                    );
                    correctButton.classList.add('btn-success');
                }
            }

            nextQuestion() {
                this.currentQuestionIndex++;

                if (this.currentQuestionIndex < this.questions.length) {
                    this.displayQuestion();
                } else {
                    this.showResults();
                }
            }

            showResults() {
                this.quizArea.style.display = 'none';
                this.resultContainer.style.display = 'block';
                this.finalScoreElement.textContent = `${this.score} / ${this.questions.length}`;
            }

            restartQuiz() {
                this.startQuiz();
            }
        }

        // Initialize the quiz application
        new QuizApp();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
